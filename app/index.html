
<html>
    <head>
        <title>VeriEd</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link rel="stylesheet" type="text/css" href="css/anime.css">
        <link rel="stylesheet" type="text/css" href="css/anime-theme.css">
        <link rel="stylesheet" type="text/css" href="css/documentation.css"> 
        <link rel="stylesheet" type="text/css" href="css/joint.css">
        <!-- <script src="js/jquery.js"></script> -->
        <script type="text/javascript" src="js/yosysjs.js"></script>
        <!-- <script>
            try {
                $ = jQuery = module.exports;
                // If you want module.exports to be empty, uncomment:
                // module.exports = {};
            } catch(e) {}
        </script> -->
        
        
    </head>


    <body>

        <div id="popup" style="position: fixed; left: 0; top: 0; width:100%; height:100%; text-align:center; z-index: 1000;"><div
            style="width:300px; margin: 200px auto; background-color: #88f; border:3px dashed #000;
            padding:15px; text-align:center;"><span id="popupmsg">Loading...</span></div>
        </div>

        <div id="main">
            <textarea id="editor" class="floating"></textarea>
            <div id="container">
            <iframe id="ys" style="width: 800px; height: 100px;"></iframe><p/>
            </div>
            <input type="button" value="After RTL Synth" onclick="synth3()">
            
            <svg id="svg" width="800"></svg>
       </div>
    </body>


    <script>
		// Monaco uses a custom amd loader that overrides node's require.
		// Keep a reference to node's require so we can restore it after executing the amd loader file.
		var nodeRequire = global.require;
	</script>

    <script type="text/javascript">
		YosysJS.load_viz();
		function on_ys_ready() {
			document.getElementById('popup').style.visibility = 'hidden';
			document.getElementById('popupmsg').textContent = 'Please wait..';
		}
        function synth3() {
                function work() {
                    document.getElementById('popup').textContent = document.getElementById('editor').innerText
                    ys.write_file("input.v", document.getElementById('editor').value);
                    ys.run('design -reset; read_verilog input.v; synth -run coarse; show -stretch');
                    YosysJS.dot_into_svg(ys.read_file('show.dot'), 'svg');
                }
                document.getElementById('popup').style.visibility = 'visible';
            window.setTimeout(work, 100);
        }
		var ys = YosysJS.create('ys', on_ys_ready);
		ys.verbose = true;
		ys.echo = true;
    </script>
    <script src="../node_modules/monaco-editor/min/vs/loader.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/renderer.js"></script>
    

</html>